(()=>{"use strict";var e,t,n,o,r,c,a,i,s,l=function(e,t){return Math.random()*(t-e)+e},u=function(e,t,n,o,r){e.beginPath(),e.moveTo(t,n);for(var c=0;c<o.length;c++){var a=o[c];e.lineTo(t,n-a),t+=r/(o.length-50)}e.stroke(),e.closePath(),e.restore()},h=function(e,t,n,o,r){var c;e.beginPath(),e.fillStyle=(4,58,void 0===(c=.5-o/5)&&(c=1),"rgba(".concat(105,",").concat(4,",").concat(58,",").concat(c,")")),e.arc(t,n,r*o,0,2*Math.PI,!1),e.fill(),e.closePath()};!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(e||(e={}));var d,f,v,g,m,w,p=function(e){n.src=e},y=function(e){e.distortion?(a.curve=null,a.curve=S(e.distortionAmount)):a.curve=null},S=function(e){void 0===e&&(e=20);for(var t=new Float32Array(256),n=0;n<256;++n){var o=2*n/256-1;t[n]=(Math.PI+e)*o/(Math.PI+e*Math.abs(o))}return t},q=function(){function e(e,t,n){this.x=e,this.y=t,this.add=n,this.rotate=0}return e.prototype.drawTriangle=function(e,t,n,o,r){var c=Math.sqrt(2/3)*o;e.save(),e.fillStyle=r,e.beginPath(),e.moveTo(t,n-c/2),e.lineTo(t+o/2,n+c/2),e.lineTo(t-o/2,n+c/2),e.closePath(),e.fill(),e.restore()},e.prototype.draw=function(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotate),this.drawTriangle(e,0,0,this.add,"rgb(180, 10, 100)"),e.restore()},e.prototype.update=function(e){var t=e[0]/255*.1;this.rotate+=t},e}(),k=function(){function e(e,t,n){this.centerX=e,this.centerY=t,this.add=n,this.n=0,this.divergence=137.1,this.c=3,this.radius=2}return e.prototype.dtr=function(e){return e*(Math.PI/180)},e.prototype.drawCircle=function(e,t,n,o,r){e.save(),e.fillStyle=r,e.beginPath(),e.arc(t,n,o,0,2*Math.PI),e.closePath(),e.fill(),e.restore()},e.prototype.draw=function(e){for(var t=0;t<this.n;t++){var n=t*this.dtr(137.1),o=2*Math.sqrt(t),r=o*Math.cos(n)+this.centerX,c=o*Math.sin(n)+this.centerY,a=Math.round(255*(1-t/this.n)),i="rgb(".concat(a,", 10, 100)");this.drawCircle(e,r,c,1,i)}},e.prototype.update=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];var o=t/(e.length+this.add);this.n=Math.floor(o/200*1e3+10)},e}(),T=[],b=[],M={showLine:!1,showBars:!0,showCircles:!1,showInvert:!1,showFireworks:!0,showTriangles:!0,highshelf:!1,lowshelf:!1,distortion:!1,toggleWave:!1,distortionAmount:20};!function(e){e.sound1="media/music/Nocturne.mp3"}(w||(w={}));var A=function(){!function(e){if(d){if(e.toggleWave?g.getByteTimeDomainData(m):g.getByteFrequencyData(m),d.save(),d.fillStyle="black",d.globalAlpha=.5,d.fillRect(0,0,f,v),d.restore(),e.showLine){d.save(),d.lineWidth=3;for(var t=-f/m.length,n=0,o=0;o<20;o++){d.lineWidth=2,d.strokeStyle="rgb(199, 199, 199)";var r=n;n+=40,u(d,t,r,m,f)}}if(e.showBars){var c=(f-2*m.length)/m.length+5;for(d.save(),o=0;o<m.length;o++){var a=2+o*(c+2),i=Math.max(m[o]+20,0),s=Math.round(o/(m.length-50)*255);d.fillStyle="rgb(".concat(s,", 10, 255, 1)"),d.fillRect(a,531-m[o],c,i)}d.restore()}if(e.showCircles){var w=v/20;for(d.save(),d.globalAlpha=.5,t=l(40,f-40),r=l(40,v-40),o=0;o<m.length;o++){var p=m[o]/255;h(d,t,r,p,p*w)}}if(e.showFireworks)for(var y=0,S=T;y<S.length;y++){var q=S[y];q.draw(d),q.update(m)}if(e.showTriangles)for(var k=0,M=b;k<M.length;k++){var A=M[k];A.draw(d),A.update(m)}var F=d.getImageData(0,0,f,v),P=F.data,I=P.length;for(o=0;o<I;o++)if(e.showInvert){var C=P[o],L=P[o+1],B=P[o+2];P[o]=255-C,P[o+1]=255-L,P[o+2]=255-B}d.putImageData(F,0,0)}}(M),setTimeout(A,1e3/60)};!function(){var l,u;l=w.sound1,u=window.AudioContext,t=new u,n=new Audio,p(l),o=t.createMediaElementSource(n),(r=t.createAnalyser()).fftSize=e.numSamples,(c=t.createGain()).gain.value=e.gain,(i=t.createBiquadFilter()).type="highshelf",(s=t.createBiquadFilter()).type="lowshelf",a=t.createWaveShaper(),o.connect(c),c.connect(i),i.connect(s),s.connect(a),a.connect(r),r.connect(t.destination),console.log("init called");var h,S,F,P=document.querySelector("canvas");(function(e){var o=document.querySelector("#btn-fs"),r=document.querySelector("#btn-play");o&&(o.onclick=function(t){var n;(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}),r&&(r.onclick=function(e){console.log("audioCtx.state before = ".concat(t.state)),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ".concat(t.state));var o=e.target;"no"==o.dataset.playing?(n.play(),o.dataset.playing="yes"):(n.pause(),o.dataset.playing="no")});var a=document.querySelector("#slider-volume"),l=document.querySelector("#label-volume");a&&(a.oninput=function(e){var t,n=e.target;t=parseFloat(n.value),t=Number(t),c.gain.value=t,l.innerHTML="".concat(Math.round(parseFloat(n.value)/2*100))},a.dispatchEvent(new Event("input")));var u=document.querySelector("#select-track");u&&(u.onchange=function(e){var t=e.target;p(t.value),"yes"==r.dataset.playing&&r.dispatchEvent(new MouseEvent("click"))});var h=document.querySelector("#cb-lines"),d=document.querySelector("#cb-fireworks"),f=document.querySelector("#cb-triangles"),v=document.querySelector("#cb-bars"),g=document.querySelector("#cb-circles"),m=document.querySelector("#cb-invert");v&&(v.checked=!0),d&&(d.checked=!0),f&&(f.checked=!0),h&&(h.onclick=function(){h.checked?M.showLine=!0:M.showLine=!1}),v&&(v.onclick=function(){v.checked?M.showBars=!0:M.showBars=!1}),g&&(g.onclick=function(){g.checked?M.showCircles=!0:M.showCircles=!1}),m&&(m.onclick=function(){m.checked?M.showInvert=!0:M.showInvert=!1}),d&&(d.onclick=function(){d.checked?M.showFireworks=!0:M.showFireworks=!1}),f&&(f.onclick=function(){f.checked?M.showTriangles=!0:M.showTriangles=!1});var w=document.querySelector("#cb-highshelf"),S=document.querySelector("#cb-lowshelf"),q=document.querySelector("#cb-distortion"),k=document.querySelector("#slider-distortion"),T=document.querySelector("#select-visualizer");w&&(w.checked=M.highshelf,w.onchange=function(e){var n=e.target;M.highshelf=n.checked,M.highshelf?(i.frequency.setValueAtTime(1e3,t.currentTime),i.gain.setValueAtTime(25,t.currentTime)):i.gain.setValueAtTime(0,t.currentTime)}),S&&(S.checked=M.lowshelf,S.onchange=function(e){var n=e.target;M.lowshelf=n.checked,M.lowshelf?(s.frequency.setValueAtTime(1e3,t.currentTime),s.gain.setValueAtTime(15,t.currentTime)):s.gain.setValueAtTime(0,t.currentTime)}),q&&(q.checked=M.distortion,q.onchange=function(e){var t=e.target;M.distortion=t.checked,y(M)}),k&&(k.value=M.distortionAmount.toString(),k.onchange=function(e){var t=e.target;M.distortionAmount=Number(t.value),y(M)}),T&&(T.onchange=function(e){"frequency"==e.target.value?M.toggleWave=!1:M.toggleWave=!0})})(P),function(e,t){e&&(d=e.getContext("2d"),f=e.width,v=e.height,g=t,m=new Uint8Array(g.fftSize/2),T.push(new k(100,100,-100)),T.push(new k(240,140,-60)),T.push(new k(200,340,200)),T.push(new k(450,200,400)),T.push(new k(500,100,100)),T.push(new k(600,300,900)),b.push(new q(770,20,27)),b.push(new q(730,30,20)),b.push(new q(770,60,20)),b.push(new q(30,530,27)),b.push(new q(40,490,20)),b.push(new q(70,520,20)))}(P,r),(h=new XMLHttpRequest).onload=function(e){var t;try{t=JSON.parse(h.responseText)}catch(e){return void(document.querySelector("#output").innerHTML="BAD JSON")}var n=t,o="";o+="<h2>".concat(n.title=n.title?n.title:"No title found","</h2>"),o+="<ol>".concat(n.songlist.map((function(e){return"<li>".concat(e,"</li>")})).join(""),"</ol>"),o+="<p>".concat(n.instructions,"</p>");var r=document.querySelector("title");r&&(r.innerHTML=n.title);var c=document.querySelector("#output");c&&(c.innerHTML=o)},h.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(h.status))},h.open("GET","data/av-data.json"),h.send(),S=document.querySelector("#burger"),F=document.querySelector("#nav-links"),S.addEventListener("click",(function(){F.classList.toggle("is-active")})),A()}()})();
//# sourceMappingURL=bundle.js.map